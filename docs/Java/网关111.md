API网关是应用程序客户端的单一入口点，它位于客户端和应用程序的后端服务集合之间。

![image-20240929210307018](assets/image-20240929210307018.png)

作用：

身份验证和安全策略实施，负载平衡和断路，协议转换和服务发现，监控、日志记录、分析和计费，缓存。

网关还提供其它关键服务，例如：网关应跟踪错误，并提供断路功能以防止服务过载。

流程

1. 客户端向API网关发送请求，该请求通常基于HTTP协议。
2. API网关验证HTTP请求。
3. API网关根据其允许列表和拒绝列表检查调用者的IP地址和其它HTTP请求头，它还可以针对IP地址和HTTP请求头等属性执行基本的速率限制检查。例如：它可以拒绝来自超过一定速率的IP地址的请求。
4. API网关将请求传递给身份验证服务，以进行身份验证和授权。API网关从身份验证服务处接收经过身份验证的会话，其中包含允许请求执行的操作范围。
5. 对经过身份验证的会话应用更高级别的速率限制检查，如果超过限制，此时请求将被拒绝。
6. 在服务发现组件的帮助下，API网关通过路径匹配找到适当的后端服务来处理请求。
7. 网关将请求转换为适当的协议，并将转换后的请求发送到后端服务（例如gRPC）。当响应从后端服务返回时，网关会将响应转换回面向公众的协议，并将响应返回给客户端。

网关是基础设置的关键部分，应将其部署到多个区域以提高可用性。