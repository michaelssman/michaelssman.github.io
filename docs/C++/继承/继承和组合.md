# 继承和组合

两种常用的程序设计方法

- 组合与继承的选择

  判断类和类之间的关系 

  - has-a  	有一个 则组合，
  - is-a。      是一个 则继承。

## 组合的例子：

汽车发动机

成员方法：

- 启动
- 后退
- 停止

汽车轮胎

- 充气

汽车车窗

- 打开
- 关闭

汽车车门

- 车门有车窗
- 打开车门
- 关闭车门

汽车  组合

- 发动机
- 4个轮胎
- 两个门

##### 附：

上面的组合还可以加上继承

- 新型的发动机 继承发动机
- 新型的轮胎 继承轮胎

汽车 （既有组合 又有继承）

	- 新型的发动机
	- 新型轮胎

## 继承的例子：

- 图形形状
  - 填充颜色
  - 线的颜色
  - 线的宽度
  - 画图形
- 圆 继承形状
  - 添加 半径
- 长方形 继承图形形状
  - 宽度
  - 高度
- 三角形 继承图形形状
- 圆角矩形 继承圆和矩形 双继承 C++可以多继承

## 组合和继承的联合

#### 例

C继承B（继承）， C里有A（组合）。既有继承又有组合。

```c++
class A {
};

class B {
};

class C : public B {
    A a;
};
```

## 再论继承和组合

- 根据是否需要向上类型转换决定继承还是组合
  - 是 --> 继承
  - 否 --> 组合
- 可以使用组合代替继承，消除多重继承

有一个类简单或者复杂的类A，使用A的时候有下面几种

1. 可以直接使用
2. 做一个新的类B继承它
3. 使用组合。在C类中有类A。做为C的成员。

例：之前做的堆栈stack，保存数据是任何数据，因为使用的万能指针。但是保存字符串的时候不方便，所以自己写一个字符串堆栈StringStack。

有两种方法：继承或组合。

### 继承

把要修改的地方重新定义。把继承下来的方法重新定义， 原方法就隐藏了。

这里修改的主要是返回值类型，和参数类型，之前是void* 现在改为string。

重写的方法里调用父类原方法。

并且子类可以在析构函数中实现delete，因为是string*，字符串指针，而父类delete要delete `void*` 万能指针，delete万能指针容易出问题，所以要由客户端自己delete。

子类比父类优点：

1. 不需要转型，直接就是字符串类型
2. 不需要delete。析构函数中就已经delete了。

如果需要向上类型转换的话（StringStack转为Stack），则使用继承。

因为上面的没有用到转换，所以应该使用组合而不是继承。

### 组合

新建一个class类 特殊的堆栈 字符串堆栈

内部有一个Stack通用的堆栈

同样的方法再实现一次，把原来的方法包装一下，然后把返回值参数类型由万能指针转成字符串类型，方便使用。

有A，B，C，X，Y，Z六个class。

新建一个class继承X，Y，Z。多继承。

多继承太复杂，容易出错，所以避免使用多重继承，用组合代替继承。

只用单继承X，另外两个使用组合，类中包含Y，Zclass。