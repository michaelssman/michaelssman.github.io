# 数据精确度

浮点数用二进制科学计数法表示的，不能精确的表示十进制0.1、0.01，进行计算时可能会有舍入。所以需要用DecimalNumber表示金钱。这样可以保证算术运算时精确的结果。

处理数据精度问题，接口返回的是Number类型，属性也得用NSNumber类型接收，value的值是正确的。

```objective-c
- (void)setValue:(id)value forKey:(NSString *)key {
    [super setValue:value forKey:key];
    if ([value isKindOfClass:[NSNumber class]]) {
        //获取类中的某个属性
        objc_property_t property = class_getProperty(object_getClass(self), key.UTF8String);
        //接口返回的字段比较多，模型里可能没有写，防空判断
        if (property) {
            //获取属性的信息：用什么修饰的
            const char *cType = property_getAttributes(property);
            NSString *typeStr = [NSString stringWithCString:cType encoding:NSUTF8StringEncoding];
            NSLog(@"type = %@",typeStr);
            if ([typeStr hasPrefix:@"T@\"NSNumber\""]) {
                //属性是NSNumber类型，调用setter方法
                //首字母大写
                NSString *firstString = [[key substringToIndex:1] uppercaseString];
                key =  [key stringByReplacingCharactersInRange:NSMakeRange(0, 1) withString:firstString];
                SEL sel = NSSelectorFromString([NSString stringWithFormat:@"set%@:",key]);
                if (sel) {
                    ((void(*)(id,SEL,id))objc_msgSend)(self,sel,value);
                }
            }
        }
    }
}
```

